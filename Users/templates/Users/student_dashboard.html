{% extends 'Users/layout.html' %}

{% block title %}
    Student Dashboard
{% endblock %}


{% block content %}
    <div id="student-dashboard" class="reg-container">
        <h2 id="student-dashboard-title" class="text-center mb-4">Student Dashboard</h2>
        <div id="student-info" class="student-info">
            <div class="card">
                <h2 class="card-header">Welcome, {{ student_name }}</h2>
                <p id="student-uid">UID: {{ uuid }}</p>
                <div class="card-body">
                    <h5 id="student-classes" class="card-title">Enrolled Classes:</h5>
                    <ul id="classes-list">
                    {% for classroom in classrooms %}
                        <li id="class{{ forloop.counter }}">
                            <h5 class="card-title">{{ classroom.class_name }}</h5>
                            <p class="card-text">{{ classroom.class_code }}</p>
                        </li>
                    {% empty %}
                        <h5>No enrolled classes found.</h5>
                    {% endfor %}
                    </ul>
                    <a href="{% url "classroom:join_class" %}" class="btn btn-primary">Join Class</a>
                </div>
            </div>            
        </div>
        <div class="card">
            <h3>Upcoming Exams</h3>
            <div class="exam-cards">
                {% for exam in upcoming_exams %}
                    <div class="exam-card">
                        <div class="exam-info">
                            <div class="exam-title">{{ exam.title }}</div>
                            <div class="exam-details">
                                <div class="exam-date">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='4' width='18' height='18' rx='2' ry='2'%3E%3C/rect%3E%3Cline x1='16' y1='2' x2='16' y2='6'%3E%3C/line%3E%3Cline x1='8' y1='2' x2='8' y2='6'%3E%3C/line%3E%3Cline x1='3' y1='10' x2='21' y2='10'%3E%3C/line%3E%3C/svg%3E" alt="Calendar">
                                    {{ exam.date }}
                                </div>
                                <div class="exam-time">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'%3E%3C/circle%3E%3Cpolyline points='12 6 12 12 16 14'%3E%3C/polyline%3E%3C/svg%3E" alt="Clock">
                                    {{ exam.time }}, {{ exam.duration }} Hours
                                </div>
                            </div>
                        </div>
                        <div class="exam-actions">
                            <button class="btn-scheduled">Scheduled</button>
                            <button class="btn-start">Start Exam</button>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
        <div class="card">
            <h3>Past Exams</h3>
            <div class="result-cards">
                {% for exam in past_exams %}
                    <div class="result-card">
                        <div class="result-info">
                            <div class="result-title">{{ exam.title }}</div>
                            <div class="result-details">
                                <div class="result-date">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/">
                                    {{ exam.date }}
                                </div>  
                                <div class="result-score">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/">
                                    {{ exam.score }} / {{ exam.total_marks }}
                                </div>
                            </div>
                        </div>
                        <div class="result-actions">
                            <button class="btn-view">View Report</button>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>        
        <div id="feedback" class="box">
            <h3 id="feedback-title" class="section-title">Feedback</h3>
            <form method="post" action="{% url 'Users:submit_feedback' %}">
                {% csrf_token %}
                <textarea id="feedback-textarea" class="feedback-textarea" name="feedback" placeholder="Provide your feedback here..."></textarea>
                <button type="submit" id="submit-feedback" class="feedback-btn">Submit Feedback</button>
            </form>
        </div>
        
        <div id="help-support" class="help">
            <h3 id="help-support-title" class="section-title">Help & Support</h3>
            <p id="faqs">FAQs for common queries</p>
            <button id="contact-support" class="help-btn">Contact Support</button>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Handle navigation item clicks
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    navItems.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                });
            });

            // Handle notification click
            const notification = document.querySelector('.notification');
            notification.addEventListener('click', () => {
                console.log('Notification clicked');
            });

            // Handle exam buttons
            const startButtons = document.querySelectorAll('.btn-start');
            startButtons.forEach(button => {
                button.addEventListener('click', () => {
                    console.log('Start exam clicked');
                });
            });

            const scheduledButtons = document.querySelectorAll('.btn-scheduled');
            scheduledButtons.forEach(button => {
                button.addEventListener('click', () => {
                    console.log('Scheduled button clicked');
                });
            });

            // Handle view report button
            const viewReportButton = document.querySelector('.btn-view');
            viewReportButton.addEventListener('click', () => {
                console.log('View report clicked');
            });
        });
    </script>
{% endblock %}
</body>
</html>
